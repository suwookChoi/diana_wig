<html lang="ko">
    
<head>
    <!--디자인팀 meta~link 정리함-->
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,width=device-width">
        
   <link rel="stylesheet" type="text/css" href="webfont.css"/>
   <link rel="stylesheet" type="text/css" href="jquery-ui.css">
   <link rel="stylesheet" type="text/css" href="daterangepicker.css">
   <link rel="stylesheet" type="text/css" href="common.css"/>
   <link rel="stylesheet" type="text/css" href="style.css"/>

   <script type="text/javascript" src="jquery-3.4.1.min.js"></script>
   <script type="text/javascript" src="jquery-ui.js"></script>
   <script type="text/javascript" src="moment.min.js"></script>
   <script type="text/javascript" src="daterangepicker.js"></script>
   <script type="text/javascript" src="common.js"></script>
   <script type="text/javascript" src="style.js"></script>
   <script type="text/javascript" src="header.js"></script>
   
   <script>
       var selectCard = new Object();
       
       $(document).ready(function(){
           
           window.webkit.messageHandlers.headerHtml.postMessage("Customer");

           getCusomerList();
           
           $(document).on("click", "#cardUl li", function(event) {
               selectCard.cardCode = $(this).find(".cardCode").text();
               selectCard.cardName = $(this).find(".cardName").text();
               selectCard.cardBalance = $(this).find(".cardBalance").text();
               selectCard.Address = $(this).find(".cardAddress").val();
               $("#cardUl li").removeClass("on");
               $(this).addClass("on");
           });
           
           $(document).on("click", ".back", function(event) {
               window.webkit.messageHandlers.close.postMessage("");
           });
         });
           
       function headerHtml(menu,id,network_stat){
           header_html("Customer List",id,"N");
       }
       function getCusomerList() {
           window.webkit.messageHandlers.customerList.postMessage("");
       }

       function html(data, networkYN, cardData) {
           if(networkYN == "N"){
               var nwContext = "";
               nwContext += "<div class='almWrap'>";
               nwContext += "    <p>";
               nwContext += "        <img src='ico_alarm.png' alt='Network connection failed'>";
               nwContext += "        Network connection failed.<br>";
               nwContext += "        (It can be different from the actual data.)";
               nwContext += "    </p>";
               nwContext += "</div>";
               
               $(".conWrap").prepend(nwContext);
           }
              
           selectCard = JSON.parse(cardData);
           
           var customerList = JSON.parse(data.replaceAll('":null', '":""'));
           
           var context = "";
           $.each(customerList, function(index, item) {
               context += "<li>";
               context += "    <dl class='lstCon lft'>";
               context += "        <dt class='cardCode'>" + item.CardCode + "</dt>";
               context += "        <dd>Balance : <span class='cardBalance'>" + (String(item.Balance) != "" ? (Math.floor(item.Balance*100)/100).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",") : "") + "</span></dd>";
               context += "    </dl>";
               context += "    <dl class='lstCon rgt'>";
               context += "        <dt class='cardName'>" + item.CardName + "</dt>";
               context += "        <input type='hidden' class='cardAddress' value='"+item.Address+"'>";
               context += "    </dl>";
               context += "</li>";
               
           });
           
           $("#cardUl").html(context);
       }

       function done() {
           if(selectCard.cardCode == null || selectCard.cardCode == 'undefined') {
                  showAlert("Notice","Please Selece Customer.");
               return false;
           }
           
           window.webkit.messageHandlers.doneCustomer.postMessage(JSON.stringify(selectCard));
       }
   
       function searchCustomerList(){
           var input = $('#findText').val();
           var filter = input.toUpperCase();

           $("#cardUl>li").each(function(index){
               var cardLi = $(this);
               var cardCode = cardLi.find('.cardCode');
               var cardName = cardLi.find('.CardName');

               if(cardCode || cardName){
                   var codeValue = cardCode.text();
                   var nameValue = cardName.text();

                   if(codeValue.toUpperCase().indexOf(filter) > -1 || nameValue.toUpperCase().indexOf(filter) > -1){
                       cardLi.attr('style','display:"";');
                       cardLi.next().attr('style','display:"";');
                   }else{
                       cardLi.attr('style','display:none;');
                       cardLi.next().attr('style','display:none;');
                   }
               }
           });
       }
   </script>
</head>

<body>
    <div id='header' class='hdWrap'></div>
    <section>
        <div class="popWrap" id="popWrap_div" style="text-align: center;"></div>
        <div class="schWrap" id="searchDiv">
            <input type="text" id="findText" name="search" placeholder="Search...">
            <button onclick="javascript:searchCustomerList();" class="btnSch">serch</button>
        </div>
        <div class="conWrap sbWrap">
<!--            <div class="almWrap">-->
<!--                <p>-->
<!--                    <img src="ico_alarm.png" alt="Network connection failed">-->
<!--                    Network connection failed.<br>-->
<!--                    (It can be different from the actual data.)-->
<!--                </p>-->
<!--            </div>-->
            <ul id="cardUl" class="lstWrap cstmList">
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CA001</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Jacqueline Edwards</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CHADE</dt>-->
<!--                        <dd>Balance : 2,082,50</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Chade Fasion ,Inc.</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li class="on">-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>AL0001-2</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>CHONG’S BEAUTY SUPPLY</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>NY0001</dt>-->
<!--                        <dd>Balance : 7,415.13</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Steven Haefner</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CA0002</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Werner Richter</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CA0002</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Werner Richter</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CA0002</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Werner Richter</dt>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li>-->
<!--                    <dl class="lstCon lft">-->
<!--                        <dt>CA0002</dt>-->
<!--                        <dd>Balance : 0.00</dd>-->
<!--                    </dl>-->
<!--                    <dl class="lstCon rgt">-->
<!--                        <dt>Werner Richter</dt>-->
<!--                    </dl>-->
<!--                </li>-->
            </ul>
        </div>
        <div class="btnWrap">
            <button class="btnDn" onclick="javascript:done();">Done</button>
        </div>
        <div class="fixBG"></div>
    </section>
</body>

</html>
